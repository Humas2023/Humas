# Humas

Update the code of Humas and the data of $MS_0$ in this repository. 

## Data
1. exp_total_qps_data_aggr2/: application-level dataset, the 2-month metrics (e.g., CPU utilization, CPU usage, RPS, and etc) of the global $MS_0$ (sample rate is 5min). All the metrics are collected from the source of the global application monitor. In this path, directory "mean/" contains the average value of metrics in each time slot, while "max/" contains the max value of metrics in each time slot.

2. hetergenous_data_exp/: the heterogeneity-aware dataset, the 2-month metrics of the group of containers on machines with diverse type of CPU models (826X,816X). All the metrics are aggregated from the source of container monitor.

3. KAE-Informer/results: the results of the RPS prediction generated by the trained models: kae-informer, lstm and informer.

4. results_lsdd_no_update/100: the results of the drift detection (training range) of the representative microservice $MS_0$. This results is computed by using the LSDD-based drift detection algorithm which identify the drifts according to the difference of probability density of the performance patterns. (time: 20220809~20220916)

5. update_config.csv: the groundtruth of the upgrades in the microservice $MS_0$ in the range of 20220804~20221028.


## Algorithms

1. usage_predict.py: We implement the class PredictUsageModel, which manage the regression models for the usage prediction/estimation. Given the workload (quantified as RPS), estimating the CPU usage to process these workload. In this version, we support five types of models: GRF (the ensemble of local linear models)/GBDT/Random Forest/GBDT/linear model. Meanwhile, we support the validation metrics for the models, namely MAPE,MSE,MAE, R2 score.

2. heter_predict_model.py: We implement the class UsageMapPredictor to accomplish the heterogeneity-aware estimation of the performance difference.

3. find_range2.py: We implement the drift detection to determine the ranage of training data for each version of the performance models. In our implementation, we realize three types of the detection algorithm (default find_train_range_dist()):

(1) def find_train_range_dist(): we realize the drift detection based on the difference between the before and current probability density functions which describe the joint distributions of the CPU usage and the workload. In this submission, we can estimate the density difference based on the three metrics: LSDD, MMD, Context-aware MMD.

(2) def find_train_range_gmm(): We realize the drift detection via classifying the distributions of the CPU usage and the workload in varying time range into diverse categories.

(3) def find_train_range_threshold(): This function implements the supervised drfit detection. When we discover that the change of RUE exceeds a specified threshold, it is regarded to an observed drift.

4. KAE-Informer: the workload forecasting algorithm, which implements based on the open source code of the reference paper "KAE-Informer: A Knowledge Auto-Embedding Informer for Forecasting Long-Term Workloads of Microservices" (https://doi.org/10.1145/3543507.3583288).

5. exp_cap_predict_new.py: the simulation of the Humas, which manages the simulated capacity adjusting of the large-scale microservices running on heterogeneous data center for about 2 months.